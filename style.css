const contentVault = [
    { type: 'arch', img: 'https://images.unsplash.com/photo-1511818966892-d7d671e672a2', caption: 'ğŸ’¡ Pritzker Insight: Minimalist glass structures increase property value by 20%.' },
    { type: 'cat', img: 'https://images.unsplash.com/photo-1635070041078-e363dbe005cb', caption: 'ğŸ§  Logic Pulse: If 5 architects design 5 firms in 5 days, how long for 100 architects?' },
    { type: 'news', img: 'https://images.unsplash.com/photo-1526304640581-d334cdbbf45e', caption: 'ğŸ“Š Market News: Real estate prices in India expected to surge. #Business' }
];

function init() {
    console.log("App Initializing...");
    renderStories();
    renderFeed();
}

function renderStories() {
    const bar = document.getElementById('story-bar');
    if (!bar) return; // Safety check
    const icons = ['ğŸ“', 'ğŸ“š', 'ğŸ’°', 'ğŸ“‰', 'ğŸ›ï¸'];
    bar.innerHTML = icons.map(icon => `
        <div class="story-circle">
            <div class="story-inner">${icon}</div>
        </div>
    `).join('');
}

function renderFeed() {
    const feed = document.getElementById('main-feed');
    if (!feed) {
        console.error("Could not find main-feed ID in HTML!");
        return;
    }

    const posts = [...contentVault, ...contentVault]; // Double the content
    
    feed.innerHTML = posts.map(post => `
        <article class="post-card">
            <div class="post-header"><b>Principal Srikanth</b></div>
            <div class="heart-container" ondblclick="triggerDopamine(this)">
                <img class="post-img" src="${post.img}" alt="post">
            </div>
            <div class="post-actions">
                <span class="like-btn" onclick="toggleLike(this)">ğŸ¤</span> <span>ğŸ’¬</span> <span>ğŸ”–</span>
            </div>
            <div class="post-caption"><b>GrowthGram</b> ${post.caption}</div>
        </article>
    `).join('');
}

function triggerDopamine(container) {
    // Sound
    const sound = document.getElementById('sound-money');
    if (sound) { sound.currentTime = 0; sound.play(); }

    // Heart Pop
    const heart = document.createElement('div');
    heart.innerHTML = 'â¤ï¸';
    heart.className = 'heart-pop';
    container.appendChild(heart);
    
    // Toggle Like Icon
    const likeBtn = container.closest('.post-card').querySelector('.like-btn');
    if (likeBtn) likeBtn.innerText = 'â¤ï¸';

    setTimeout(() => heart.remove(), 800);
}

function toggleLike(btn) {
    btn.innerText = (btn.innerText === 'ğŸ¤') ? 'â¤ï¸' : 'ğŸ¤';
}

// THIS IS THE MOST IMPORTANT PART:
// It waits for the whole page to load before running the JS.
window.addEventListener('DOMContentLoaded', init);
